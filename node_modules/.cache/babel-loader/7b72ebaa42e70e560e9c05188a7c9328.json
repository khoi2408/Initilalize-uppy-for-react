{"ast":null,"code":"'use strict';\n\nimport _slicedToArray from \"E:/integrate cloud/uppy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _defineProperty from \"E:/integrate cloud/uppy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport _regeneratorRuntime from \"E:/integrate cloud/uppy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _objectSpread from \"E:/integrate cloud/uppy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _classCallCheck from \"E:/integrate cloud/uppy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"E:/integrate cloud/uppy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _asyncToGenerator from \"E:/integrate cloud/uppy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _Symbol$for;\nfunction _classPrivateFieldLooseBase(receiver, privateKey) {\n  if (!Object.prototype.hasOwnProperty.call(receiver, privateKey)) {\n    throw new TypeError(\"attempted to use private field on non-instance\");\n  }\n  return receiver;\n}\nvar id = 0;\nfunction _classPrivateFieldLooseKey(name) {\n  return \"__private_\" + id++ + \"_\" + name;\n}\nimport fetchWithNetworkError from '@uppy/utils/lib/fetchWithNetworkError';\nimport ErrorWithCause from '@uppy/utils/lib/ErrorWithCause';\nimport AuthError from './AuthError.js';\nvar packageJson = {\n  \"version\": \"3.1.1\"\n}; // Remove the trailing slash so we can always safely append /xyz.\n\nfunction stripSlash(url) {\n  return url.replace(/\\/$/, '');\n}\nfunction handleJSONResponse(_x) {\n  return _handleJSONResponse.apply(this, arguments);\n} // todo pull out into core instead?\nfunction _handleJSONResponse() {\n  _handleJSONResponse = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee8(res) {\n    var jsonPromise, errMsg, errData;\n    return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n      while (1) switch (_context8.prev = _context8.next) {\n        case 0:\n          if (!(res.status === 401)) {\n            _context8.next = 2;\n            break;\n          }\n          throw new AuthError();\n        case 2:\n          jsonPromise = res.json();\n          if (!res.ok) {\n            _context8.next = 5;\n            break;\n          }\n          return _context8.abrupt(\"return\", jsonPromise);\n        case 5:\n          errMsg = \"Failed request with status: \".concat(res.status, \". \").concat(res.statusText);\n          _context8.prev = 6;\n          _context8.next = 9;\n          return jsonPromise;\n        case 9:\n          errData = _context8.sent;\n          errMsg = errData.message ? \"\".concat(errMsg, \" message: \").concat(errData.message) : errMsg;\n          errMsg = errData.requestId ? \"\".concat(errMsg, \" request-Id: \").concat(errData.requestId) : errMsg;\n          _context8.next = 16;\n          break;\n        case 14:\n          _context8.prev = 14;\n          _context8.t0 = _context8[\"catch\"](6);\n        case 16:\n          throw new Error(errMsg);\n        case 17:\n        case \"end\":\n          return _context8.stop();\n      }\n    }, _callee8, null, [[6, 14]]);\n  }));\n  return _handleJSONResponse.apply(this, arguments);\n}\nvar allowedHeadersCache = new Map();\nvar _companionHeaders = /*#__PURE__*/_classPrivateFieldLooseKey(\"companionHeaders\");\nvar _getUrl = /*#__PURE__*/_classPrivateFieldLooseKey(\"getUrl\");\nvar _request = /*#__PURE__*/_classPrivateFieldLooseKey(\"request\");\n_Symbol$for = Symbol.for('uppy test: getCompanionHeaders');\nvar RequestClient = /*#__PURE__*/function (_Symbol$for2) {\n  function RequestClient(uppy, opts) {\n    _classCallCheck(this, RequestClient);\n    Object.defineProperty(this, _request, {\n      value: _request2\n    });\n    Object.defineProperty(this, _getUrl, {\n      value: _getUrl2\n    });\n    Object.defineProperty(this, _companionHeaders, {\n      writable: true,\n      value: void 0\n    });\n    this.uppy = uppy;\n    this.opts = opts;\n    this.onReceiveResponse = this.onReceiveResponse.bind(this);\n    _classPrivateFieldLooseBase(this, _companionHeaders)[_companionHeaders] = opts == null ? void 0 : opts.companionHeaders;\n  }\n  _createClass(RequestClient, [{\n    key: \"setCompanionHeaders\",\n    value: function setCompanionHeaders(headers) {\n      _classPrivateFieldLooseBase(this, _companionHeaders)[_companionHeaders] = headers;\n    }\n  }, {\n    key: _Symbol$for2,\n    value: function value() {\n      return _classPrivateFieldLooseBase(this, _companionHeaders)[_companionHeaders];\n    }\n  }, {\n    key: \"hostname\",\n    get: function get() {\n      var _this$uppy$getState = this.uppy.getState(),\n        companion = _this$uppy$getState.companion;\n      var host = this.opts.companionUrl;\n      return stripSlash(companion && companion[host] ? companion[host] : host);\n    }\n  }, {\n    key: \"headers\",\n    value: function () {\n      var _headers = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var defaultHeaders;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              defaultHeaders = {\n                Accept: 'application/json',\n                'Content-Type': 'application/json',\n                'Uppy-Versions': \"@uppy/companion-client=\".concat(RequestClient.VERSION)\n              };\n              return _context.abrupt(\"return\", _objectSpread(_objectSpread({}, defaultHeaders), _classPrivateFieldLooseBase(this, _companionHeaders)[_companionHeaders]));\n            case 2:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this);\n      }));\n      function headers() {\n        return _headers.apply(this, arguments);\n      }\n      return headers;\n    }()\n  }, {\n    key: \"onReceiveResponse\",\n    value: function onReceiveResponse(_ref) {\n      var headers = _ref.headers;\n      var state = this.uppy.getState();\n      var companion = state.companion || {};\n      var host = this.opts.companionUrl; // Store the self-identified domain name for the Companion instance we just hit.\n\n      if (headers.has('i-am') && headers.get('i-am') !== companion[host]) {\n        this.uppy.setState({\n          companion: _objectSpread(_objectSpread({}, companion), {}, _defineProperty({}, host, headers.get('i-am')))\n        });\n      }\n    }\n\n    /*\n      Preflight was added to avoid breaking change between older Companion-client versions and\n      newer Companion versions and vice-versa. Usually the break will manifest via CORS errors because a\n      version of companion-client could be sending certain headers to a version of Companion server that\n      does not support those headers. In which case, the default preflight would lead to CORS.\n      So to avoid those errors, we do preflight ourselves, to see what headers the Companion server\n      we are communicating with allows. And based on that, companion-client knows what headers to\n      send and what headers to not send.\n       The preflight only happens once throughout the life-cycle of a certain\n      Companion-client <-> Companion-server pair (allowedHeadersCache).\n      Subsequent requests use the cached result of the preflight.\n      However if there is an error retrieving the allowed headers, we will try again next time\n    */\n  }, {\n    key: \"preflight\",\n    value: function () {\n      var _preflight = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(path) {\n        var _this = this;\n        var allowedHeadersCached, fallbackAllowedHeaders, promise;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              allowedHeadersCached = allowedHeadersCache.get(this.hostname);\n              if (!(allowedHeadersCached != null)) {\n                _context3.next = 3;\n                break;\n              }\n              return _context3.abrupt(\"return\", allowedHeadersCached);\n            case 3:\n              fallbackAllowedHeaders = ['accept', 'content-type', 'uppy-auth-token'];\n              promise = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n                var response, header, allowedHeaders;\n                return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n                  while (1) switch (_context2.prev = _context2.next) {\n                    case 0:\n                      _context2.prev = 0;\n                      _context2.next = 3;\n                      return fetch(_classPrivateFieldLooseBase(_this, _getUrl)[_getUrl](path), {\n                        method: 'OPTIONS'\n                      });\n                    case 3:\n                      response = _context2.sent;\n                      header = response.headers.get('access-control-allow-headers');\n                      if (!(header == null || header === '*')) {\n                        _context2.next = 8;\n                        break;\n                      }\n                      allowedHeadersCache.set(_this.hostname, fallbackAllowedHeaders);\n                      return _context2.abrupt(\"return\", fallbackAllowedHeaders);\n                    case 8:\n                      _this.uppy.log(\"[CompanionClient] adding allowed preflight headers to companion cache: \".concat(_this.hostname, \" \").concat(header));\n                      allowedHeaders = header.split(',').map(function (headerName) {\n                        return headerName.trim().toLowerCase();\n                      });\n                      allowedHeadersCache.set(_this.hostname, allowedHeaders);\n                      return _context2.abrupt(\"return\", allowedHeaders);\n                    case 14:\n                      _context2.prev = 14;\n                      _context2.t0 = _context2[\"catch\"](0);\n                      _this.uppy.log(\"[CompanionClient] unable to make preflight request \".concat(_context2.t0), 'warning'); // If the user gets a network error or similar, we should try preflight\n                      // again next time, or else we might get incorrect behaviour.\n\n                      allowedHeadersCache.delete(_this.hostname); // re-fetch next time\n                      return _context2.abrupt(\"return\", fallbackAllowedHeaders);\n                    case 19:\n                    case \"end\":\n                      return _context2.stop();\n                  }\n                }, _callee2, null, [[0, 14]]);\n              }))();\n              allowedHeadersCache.set(this.hostname, promise);\n              return _context3.abrupt(\"return\", promise);\n            case 7:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3, this);\n      }));\n      function preflight(_x2) {\n        return _preflight.apply(this, arguments);\n      }\n      return preflight;\n    }()\n  }, {\n    key: \"preflightAndHeaders\",\n    value: function () {\n      var _preflightAndHeaders = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(path) {\n        var _this2 = this;\n        var _yield$Promise$all, _yield$Promise$all2, allowedHeaders, headers;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return Promise.all([this.preflight(path), this.headers()]);\n            case 2:\n              _yield$Promise$all = _context4.sent;\n              _yield$Promise$all2 = _slicedToArray(_yield$Promise$all, 2);\n              allowedHeaders = _yield$Promise$all2[0];\n              headers = _yield$Promise$all2[1];\n              return _context4.abrupt(\"return\", Object.fromEntries(Object.entries(headers).filter(function (_ref2) {\n                var _ref5 = _slicedToArray(_ref2, 1),\n                  header = _ref5[0];\n                if (!allowedHeaders.includes(header.toLowerCase())) {\n                  _this2.uppy.log(\"[CompanionClient] excluding disallowed header \".concat(header));\n                  return false;\n                }\n                return true;\n              })));\n            case 7:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4, this);\n      }));\n      function preflightAndHeaders(_x3) {\n        return _preflightAndHeaders.apply(this, arguments);\n      }\n      return preflightAndHeaders;\n    }()\n  }, {\n    key: \"get\",\n    value: function () {\n      var _get = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5(path, options) {\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) switch (_context5.prev = _context5.next) {\n            case 0:\n              if (options === void 0) {\n                options = undefined;\n              }\n\n              // TODO: remove boolean support for options that was added for backward compatibility.\n              // eslint-disable-next-line no-param-reassign\n              if (typeof options === 'boolean') options = {\n                skipPostResponse: options\n              };\n              return _context5.abrupt(\"return\", _classPrivateFieldLooseBase(this, _request)[_request](_objectSpread(_objectSpread({}, options), {}, {\n                path: path\n              })));\n            case 3:\n            case \"end\":\n              return _context5.stop();\n          }\n        }, _callee5, this);\n      }));\n      function get(_x4, _x5) {\n        return _get.apply(this, arguments);\n      }\n      return get;\n    }()\n  }, {\n    key: \"post\",\n    value: function () {\n      var _post = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6(path, data, options) {\n        return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n          while (1) switch (_context6.prev = _context6.next) {\n            case 0:\n              if (options === void 0) {\n                options = undefined;\n              }\n\n              // TODO: remove boolean support for options that was added for backward compatibility.\n              // eslint-disable-next-line no-param-reassign\n              if (typeof options === 'boolean') options = {\n                skipPostResponse: options\n              };\n              return _context6.abrupt(\"return\", _classPrivateFieldLooseBase(this, _request)[_request](_objectSpread(_objectSpread({}, options), {}, {\n                path: path,\n                method: 'POST',\n                data: data\n              })));\n            case 3:\n            case \"end\":\n              return _context6.stop();\n          }\n        }, _callee6, this);\n      }));\n      function post(_x6, _x7, _x8) {\n        return _post.apply(this, arguments);\n      }\n      return post;\n    }()\n  }, {\n    key: \"delete\",\n    value: function () {\n      var _delete2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee7(path, data, options) {\n        return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n          while (1) switch (_context7.prev = _context7.next) {\n            case 0:\n              if (data === void 0) {\n                data = undefined;\n              }\n\n              // TODO: remove boolean support for options that was added for backward compatibility.\n              // eslint-disable-next-line no-param-reassign\n              if (typeof options === 'boolean') options = {\n                skipPostResponse: options\n              };\n              return _context7.abrupt(\"return\", _classPrivateFieldLooseBase(this, _request)[_request](_objectSpread(_objectSpread({}, options), {}, {\n                path: path,\n                method: 'DELETE',\n                data: data\n              })));\n            case 3:\n            case \"end\":\n              return _context7.stop();\n          }\n        }, _callee7, this);\n      }));\n      function _delete(_x9, _x10, _x11) {\n        return _delete2.apply(this, arguments);\n      }\n      return _delete;\n    }()\n  }]);\n  return RequestClient;\n}(_Symbol$for);\nexport { RequestClient as default };\nfunction _getUrl2(url) {\n  if (/^(https?:|)\\/\\//.test(url)) {\n    return url;\n  }\n  return \"\".concat(this.hostname, \"/\").concat(url);\n}\nfunction _request2(_x12) {\n  return _request3.apply(this, arguments);\n}\nfunction _request3() {\n  _request3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee9(_ref3) {\n    var path, _ref3$method, method, data, skipPostResponse, signal, headers, response;\n    return _regeneratorRuntime().wrap(function _callee9$(_context9) {\n      while (1) switch (_context9.prev = _context9.next) {\n        case 0:\n          path = _ref3.path, _ref3$method = _ref3.method, method = _ref3$method === void 0 ? 'GET' : _ref3$method, data = _ref3.data, skipPostResponse = _ref3.skipPostResponse, signal = _ref3.signal;\n          _context9.prev = 1;\n          _context9.next = 4;\n          return this.preflightAndHeaders(path);\n        case 4:\n          headers = _context9.sent;\n          _context9.next = 7;\n          return fetchWithNetworkError(_classPrivateFieldLooseBase(this, _getUrl)[_getUrl](path), {\n            method: method,\n            signal: signal,\n            headers: headers,\n            credentials: this.opts.companionCookiesRule || 'same-origin',\n            body: data ? JSON.stringify(data) : null\n          });\n        case 7:\n          response = _context9.sent;\n          if (!skipPostResponse) this.onReceiveResponse(response);\n          return _context9.abrupt(\"return\", handleJSONResponse(response));\n        case 12:\n          _context9.prev = 12;\n          _context9.t0 = _context9[\"catch\"](1);\n          if (!(_context9.t0 != null && _context9.t0.isAuthError)) {\n            _context9.next = 16;\n            break;\n          }\n          throw _context9.t0;\n        case 16:\n          throw new ErrorWithCause(\"Could not \".concat(method, \" \").concat(_classPrivateFieldLooseBase(this, _getUrl)[_getUrl](path)), {\n            cause: _context9.t0\n          });\n        case 17:\n        case \"end\":\n          return _context9.stop();\n      }\n    }, _callee9, this, [[1, 12]]);\n  }));\n  return _request3.apply(this, arguments);\n}\nRequestClient.VERSION = packageJson.version;","map":{"version":3,"names":["_slicedToArray","_defineProperty","_regeneratorRuntime","_objectSpread","_classCallCheck","_createClass","_asyncToGenerator","_Symbol$for","_classPrivateFieldLooseBase","receiver","privateKey","Object","prototype","hasOwnProperty","call","TypeError","id","_classPrivateFieldLooseKey","name","fetchWithNetworkError","ErrorWithCause","AuthError","packageJson","stripSlash","url","replace","handleJSONResponse","_x","_handleJSONResponse","apply","arguments","mark","_callee8","res","jsonPromise","errMsg","errData","wrap","_callee8$","_context8","prev","next","status","json","ok","abrupt","concat","statusText","sent","message","requestId","t0","Error","stop","allowedHeadersCache","Map","_companionHeaders","_getUrl","_request","Symbol","for","RequestClient","_Symbol$for2","uppy","opts","defineProperty","value","_request2","_getUrl2","writable","onReceiveResponse","bind","companionHeaders","key","setCompanionHeaders","headers","get","_this$uppy$getState","getState","companion","host","companionUrl","_headers","_callee","defaultHeaders","_callee$","_context","Accept","VERSION","_ref","state","has","setState","_preflight","_callee3","path","_this","allowedHeadersCached","fallbackAllowedHeaders","promise","_callee3$","_context3","hostname","_callee2","response","header","allowedHeaders","_callee2$","_context2","fetch","method","set","log","split","map","headerName","trim","toLowerCase","delete","preflight","_x2","_preflightAndHeaders","_callee4","_this2","_yield$Promise$all","_yield$Promise$all2","_callee4$","_context4","Promise","all","fromEntries","entries","filter","_ref2","_ref5","includes","preflightAndHeaders","_x3","_get","_callee5","options","_callee5$","_context5","undefined","skipPostResponse","_x4","_x5","_post","_callee6","data","_callee6$","_context6","post","_x6","_x7","_x8","_delete2","_callee7","_callee7$","_context7","_delete","_x9","_x10","_x11","default","test","_x12","_request3","_callee9","_ref3","_ref3$method","signal","_callee9$","_context9","credentials","companionCookiesRule","body","JSON","stringify","isAuthError","cause","version"],"sources":["E:/integrate cloud/uppy/node_modules/@uppy/dropbox/node_modules/@uppy/companion-client/lib/RequestClient.js"],"sourcesContent":["'use strict';\n\nlet _Symbol$for;\n\nfunction _classPrivateFieldLooseBase(receiver, privateKey) { if (!Object.prototype.hasOwnProperty.call(receiver, privateKey)) { throw new TypeError(\"attempted to use private field on non-instance\"); } return receiver; }\n\nvar id = 0;\n\nfunction _classPrivateFieldLooseKey(name) { return \"__private_\" + id++ + \"_\" + name; }\n\nimport fetchWithNetworkError from '@uppy/utils/lib/fetchWithNetworkError';\nimport ErrorWithCause from '@uppy/utils/lib/ErrorWithCause';\nimport AuthError from './AuthError.js';\nconst packageJson = {\n  \"version\": \"3.1.1\"\n}; // Remove the trailing slash so we can always safely append /xyz.\n\nfunction stripSlash(url) {\n  return url.replace(/\\/$/, '');\n}\n\nasync function handleJSONResponse(res) {\n  if (res.status === 401) {\n    throw new AuthError();\n  }\n\n  const jsonPromise = res.json();\n\n  if (res.ok) {\n    return jsonPromise;\n  }\n\n  let errMsg = `Failed request with status: ${res.status}. ${res.statusText}`;\n\n  try {\n    const errData = await jsonPromise;\n    errMsg = errData.message ? `${errMsg} message: ${errData.message}` : errMsg;\n    errMsg = errData.requestId ? `${errMsg} request-Id: ${errData.requestId}` : errMsg;\n  } catch {\n    /* if the response contains invalid JSON, let's ignore the error */\n  }\n\n  throw new Error(errMsg);\n} // todo pull out into core instead?\n\n\nconst allowedHeadersCache = new Map();\n\nvar _companionHeaders = /*#__PURE__*/_classPrivateFieldLooseKey(\"companionHeaders\");\n\nvar _getUrl = /*#__PURE__*/_classPrivateFieldLooseKey(\"getUrl\");\n\nvar _request = /*#__PURE__*/_classPrivateFieldLooseKey(\"request\");\n\n_Symbol$for = Symbol.for('uppy test: getCompanionHeaders');\nexport default class RequestClient {\n  constructor(uppy, opts) {\n    Object.defineProperty(this, _request, {\n      value: _request2\n    });\n    Object.defineProperty(this, _getUrl, {\n      value: _getUrl2\n    });\n    Object.defineProperty(this, _companionHeaders, {\n      writable: true,\n      value: void 0\n    });\n    this.uppy = uppy;\n    this.opts = opts;\n    this.onReceiveResponse = this.onReceiveResponse.bind(this);\n    _classPrivateFieldLooseBase(this, _companionHeaders)[_companionHeaders] = opts == null ? void 0 : opts.companionHeaders;\n  }\n\n  setCompanionHeaders(headers) {\n    _classPrivateFieldLooseBase(this, _companionHeaders)[_companionHeaders] = headers;\n  }\n\n  [_Symbol$for]() {\n    return _classPrivateFieldLooseBase(this, _companionHeaders)[_companionHeaders];\n  }\n\n  get hostname() {\n    const {\n      companion\n    } = this.uppy.getState();\n    const host = this.opts.companionUrl;\n    return stripSlash(companion && companion[host] ? companion[host] : host);\n  }\n\n  async headers() {\n    const defaultHeaders = {\n      Accept: 'application/json',\n      'Content-Type': 'application/json',\n      'Uppy-Versions': `@uppy/companion-client=${RequestClient.VERSION}`\n    };\n    return { ...defaultHeaders,\n      ..._classPrivateFieldLooseBase(this, _companionHeaders)[_companionHeaders]\n    };\n  }\n\n  onReceiveResponse(_ref) {\n    let {\n      headers\n    } = _ref;\n    const state = this.uppy.getState();\n    const companion = state.companion || {};\n    const host = this.opts.companionUrl; // Store the self-identified domain name for the Companion instance we just hit.\n\n    if (headers.has('i-am') && headers.get('i-am') !== companion[host]) {\n      this.uppy.setState({\n        companion: { ...companion,\n          [host]: headers.get('i-am')\n        }\n      });\n    }\n  }\n\n  /*\n    Preflight was added to avoid breaking change between older Companion-client versions and\n    newer Companion versions and vice-versa. Usually the break will manifest via CORS errors because a\n    version of companion-client could be sending certain headers to a version of Companion server that\n    does not support those headers. In which case, the default preflight would lead to CORS.\n    So to avoid those errors, we do preflight ourselves, to see what headers the Companion server\n    we are communicating with allows. And based on that, companion-client knows what headers to\n    send and what headers to not send.\n     The preflight only happens once throughout the life-cycle of a certain\n    Companion-client <-> Companion-server pair (allowedHeadersCache).\n    Subsequent requests use the cached result of the preflight.\n    However if there is an error retrieving the allowed headers, we will try again next time\n  */\n  async preflight(path) {\n    const allowedHeadersCached = allowedHeadersCache.get(this.hostname);\n    if (allowedHeadersCached != null) return allowedHeadersCached;\n    const fallbackAllowedHeaders = ['accept', 'content-type', 'uppy-auth-token'];\n\n    const promise = (async () => {\n      try {\n        const response = await fetch(_classPrivateFieldLooseBase(this, _getUrl)[_getUrl](path), {\n          method: 'OPTIONS'\n        });\n        const header = response.headers.get('access-control-allow-headers');\n\n        if (header == null || header === '*') {\n          allowedHeadersCache.set(this.hostname, fallbackAllowedHeaders);\n          return fallbackAllowedHeaders;\n        }\n\n        this.uppy.log(`[CompanionClient] adding allowed preflight headers to companion cache: ${this.hostname} ${header}`);\n        const allowedHeaders = header.split(',').map(headerName => headerName.trim().toLowerCase());\n        allowedHeadersCache.set(this.hostname, allowedHeaders);\n        return allowedHeaders;\n      } catch (err) {\n        this.uppy.log(`[CompanionClient] unable to make preflight request ${err}`, 'warning'); // If the user gets a network error or similar, we should try preflight\n        // again next time, or else we might get incorrect behaviour.\n\n        allowedHeadersCache.delete(this.hostname); // re-fetch next time\n\n        return fallbackAllowedHeaders;\n      }\n    })();\n\n    allowedHeadersCache.set(this.hostname, promise);\n    return promise;\n  }\n\n  async preflightAndHeaders(path) {\n    const [allowedHeaders, headers] = await Promise.all([this.preflight(path), this.headers()]); // filter to keep only allowed Headers\n\n    return Object.fromEntries(Object.entries(headers).filter(_ref2 => {\n      let [header] = _ref2;\n\n      if (!allowedHeaders.includes(header.toLowerCase())) {\n        this.uppy.log(`[CompanionClient] excluding disallowed header ${header}`);\n        return false;\n      }\n\n      return true;\n    }));\n  }\n\n  async get(path, options) {\n    if (options === void 0) {\n      options = undefined;\n    }\n\n    // TODO: remove boolean support for options that was added for backward compatibility.\n    // eslint-disable-next-line no-param-reassign\n    if (typeof options === 'boolean') options = {\n      skipPostResponse: options\n    };\n    return _classPrivateFieldLooseBase(this, _request)[_request]({ ...options,\n      path\n    });\n  }\n\n  async post(path, data, options) {\n    if (options === void 0) {\n      options = undefined;\n    }\n\n    // TODO: remove boolean support for options that was added for backward compatibility.\n    // eslint-disable-next-line no-param-reassign\n    if (typeof options === 'boolean') options = {\n      skipPostResponse: options\n    };\n    return _classPrivateFieldLooseBase(this, _request)[_request]({ ...options,\n      path,\n      method: 'POST',\n      data\n    });\n  }\n\n  async delete(path, data, options) {\n    if (data === void 0) {\n      data = undefined;\n    }\n\n    // TODO: remove boolean support for options that was added for backward compatibility.\n    // eslint-disable-next-line no-param-reassign\n    if (typeof options === 'boolean') options = {\n      skipPostResponse: options\n    };\n    return _classPrivateFieldLooseBase(this, _request)[_request]({ ...options,\n      path,\n      method: 'DELETE',\n      data\n    });\n  }\n\n}\n\nfunction _getUrl2(url) {\n  if (/^(https?:|)\\/\\//.test(url)) {\n    return url;\n  }\n\n  return `${this.hostname}/${url}`;\n}\n\nasync function _request2(_ref3) {\n  let {\n    path,\n    method = 'GET',\n    data,\n    skipPostResponse,\n    signal\n  } = _ref3;\n\n  try {\n    const headers = await this.preflightAndHeaders(path);\n    const response = await fetchWithNetworkError(_classPrivateFieldLooseBase(this, _getUrl)[_getUrl](path), {\n      method,\n      signal,\n      headers,\n      credentials: this.opts.companionCookiesRule || 'same-origin',\n      body: data ? JSON.stringify(data) : null\n    });\n    if (!skipPostResponse) this.onReceiveResponse(response);\n    return handleJSONResponse(response);\n  } catch (err) {\n    if (err != null && err.isAuthError) throw err;\n    throw new ErrorWithCause(`Could not ${method} ${_classPrivateFieldLooseBase(this, _getUrl)[_getUrl](path)}`, {\n      cause: err\n    });\n  }\n}\n\nRequestClient.VERSION = packageJson.version;"],"mappings":"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"},"metadata":{},"sourceType":"module"}
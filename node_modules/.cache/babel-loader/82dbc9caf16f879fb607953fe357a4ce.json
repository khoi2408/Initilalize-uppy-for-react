{"ast":null,"code":"var remoteFileObjToLocal = require('@uppy/utils/lib/remoteFileObjToLocal');\nmodule.exports = /*#__PURE__*/function () {\n  function SharedHandler(plugin) {\n    this.plugin = plugin;\n    this.filterItems = this.filterItems.bind(this);\n    this.toggleCheckbox = this.toggleCheckbox.bind(this);\n    this.isChecked = this.isChecked.bind(this);\n    this.loaderWrapper = this.loaderWrapper.bind(this);\n  }\n  var _proto = SharedHandler.prototype;\n  _proto.filterItems = function filterItems(items) {\n    var state = this.plugin.getPluginState();\n    if (!state.filterInput || state.filterInput === '') {\n      return items;\n    }\n    return items.filter(function (folder) {\n      return folder.name.toLowerCase().indexOf(state.filterInput.toLowerCase()) !== -1;\n    });\n  }\n  /**\n   * Toggles file/folder checkbox to on/off state while updating files list.\n   *\n   * Note that some extra complexity comes from supporting shift+click to\n   * toggle multiple checkboxes at once, which is done by getting all files\n   * in between last checked file and current one.\n   */;\n\n  _proto.toggleCheckbox = function toggleCheckbox(e, file) {\n    var _this = this;\n    e.stopPropagation();\n    e.preventDefault();\n    e.currentTarget.focus();\n    var _this$plugin$getPlugi = this.plugin.getPluginState(),\n      folders = _this$plugin$getPlugi.folders,\n      files = _this$plugin$getPlugi.files;\n    var items = this.filterItems(folders.concat(files)); // Shift-clicking selects a single consecutive list of items\n    // starting at the previous click and deselects everything else.\n\n    if (this.lastCheckbox && e.shiftKey) {\n      var _currentSelection;\n      var prevIndex = items.indexOf(this.lastCheckbox);\n      var currentIndex = items.indexOf(file);\n      if (prevIndex < currentIndex) {\n        _currentSelection = items.slice(prevIndex, currentIndex + 1);\n      } else {\n        _currentSelection = items.slice(currentIndex, prevIndex + 1);\n      } // Check restrictions on each file in currentSelection,\n      // reduce it to only contain files that pass restrictions\n\n      _currentSelection = _currentSelection.reduce(function (reducedCurrentSelection, item) {\n        var uppy = _this.plugin.uppy;\n        var validatedRestrictions = uppy.validateRestrictions(remoteFileObjToLocal(item), [].concat(uppy.getFiles(), reducedCurrentSelection));\n        if (!validatedRestrictions.result) {\n          uppy.info({\n            message: validatedRestrictions.reason\n          }, 'error', uppy.opts.infoTimeout);\n          return reducedCurrentSelection;\n        }\n        return [].concat(reducedCurrentSelection, [item]);\n      });\n      this.plugin.setPluginState({\n        currentSelection: _currentSelection\n      });\n      return;\n    }\n    this.lastCheckbox = file;\n    var _this$plugin$getPlugi2 = this.plugin.getPluginState(),\n      currentSelection = _this$plugin$getPlugi2.currentSelection;\n    if (this.isChecked(file)) {\n      this.plugin.setPluginState({\n        currentSelection: currentSelection.filter(function (item) {\n          return item.id !== file.id;\n        })\n      });\n    } else {\n      this.plugin.setPluginState({\n        currentSelection: currentSelection.concat([file])\n      });\n    }\n  };\n  _proto.isChecked = function isChecked(file) {\n    var _this$plugin$getPlugi3 = this.plugin.getPluginState(),\n      currentSelection = _this$plugin$getPlugi3.currentSelection; // comparing id instead of the file object, because the reference to the object\n    // changes when we switch folders, and the file list is updated\n\n    return currentSelection.some(function (item) {\n      return item.id === file.id;\n    });\n  };\n  _proto.loaderWrapper = function loaderWrapper(promise, then, catch_) {\n    var _this2 = this;\n    promise.then(function (result) {\n      _this2.plugin.setPluginState({\n        loading: false\n      });\n      then(result);\n    }).catch(function (err) {\n      _this2.plugin.setPluginState({\n        loading: false\n      });\n      catch_(err);\n    });\n    this.plugin.setPluginState({\n      loading: true\n    });\n  };\n  return SharedHandler;\n}();","map":{"version":3,"names":["remoteFileObjToLocal","require","module","exports","SharedHandler","plugin","filterItems","bind","toggleCheckbox","isChecked","loaderWrapper","_proto","prototype","items","state","getPluginState","filterInput","filter","folder","name","toLowerCase","indexOf","e","file","_this","stopPropagation","preventDefault","currentTarget","focus","_this$plugin$getPlugi","folders","files","concat","lastCheckbox","shiftKey","_currentSelection","prevIndex","currentIndex","slice","reduce","reducedCurrentSelection","item","uppy","validatedRestrictions","validateRestrictions","getFiles","result","info","message","reason","opts","infoTimeout","setPluginState","currentSelection","_this$plugin$getPlugi2","id","_this$plugin$getPlugi3","some","promise","then","catch_","_this2","loading","catch","err"],"sources":["E:/integrate cloud/uppy/node_modules/@uppy/provider-views/lib/SharedHandler.js"],"sourcesContent":["var remoteFileObjToLocal = require('@uppy/utils/lib/remoteFileObjToLocal');\n\nmodule.exports = /*#__PURE__*/function () {\n  function SharedHandler(plugin) {\n    this.plugin = plugin;\n    this.filterItems = this.filterItems.bind(this);\n    this.toggleCheckbox = this.toggleCheckbox.bind(this);\n    this.isChecked = this.isChecked.bind(this);\n    this.loaderWrapper = this.loaderWrapper.bind(this);\n  }\n\n  var _proto = SharedHandler.prototype;\n\n  _proto.filterItems = function filterItems(items) {\n    var state = this.plugin.getPluginState();\n\n    if (!state.filterInput || state.filterInput === '') {\n      return items;\n    }\n\n    return items.filter(function (folder) {\n      return folder.name.toLowerCase().indexOf(state.filterInput.toLowerCase()) !== -1;\n    });\n  }\n  /**\n   * Toggles file/folder checkbox to on/off state while updating files list.\n   *\n   * Note that some extra complexity comes from supporting shift+click to\n   * toggle multiple checkboxes at once, which is done by getting all files\n   * in between last checked file and current one.\n   */\n  ;\n\n  _proto.toggleCheckbox = function toggleCheckbox(e, file) {\n    var _this = this;\n\n    e.stopPropagation();\n    e.preventDefault();\n    e.currentTarget.focus();\n\n    var _this$plugin$getPlugi = this.plugin.getPluginState(),\n        folders = _this$plugin$getPlugi.folders,\n        files = _this$plugin$getPlugi.files;\n\n    var items = this.filterItems(folders.concat(files)); // Shift-clicking selects a single consecutive list of items\n    // starting at the previous click and deselects everything else.\n\n    if (this.lastCheckbox && e.shiftKey) {\n      var _currentSelection;\n\n      var prevIndex = items.indexOf(this.lastCheckbox);\n      var currentIndex = items.indexOf(file);\n\n      if (prevIndex < currentIndex) {\n        _currentSelection = items.slice(prevIndex, currentIndex + 1);\n      } else {\n        _currentSelection = items.slice(currentIndex, prevIndex + 1);\n      } // Check restrictions on each file in currentSelection,\n      // reduce it to only contain files that pass restrictions\n\n\n      _currentSelection = _currentSelection.reduce(function (reducedCurrentSelection, item) {\n        var uppy = _this.plugin.uppy;\n        var validatedRestrictions = uppy.validateRestrictions(remoteFileObjToLocal(item), [].concat(uppy.getFiles(), reducedCurrentSelection));\n\n        if (!validatedRestrictions.result) {\n          uppy.info({\n            message: validatedRestrictions.reason\n          }, 'error', uppy.opts.infoTimeout);\n          return reducedCurrentSelection;\n        }\n\n        return [].concat(reducedCurrentSelection, [item]);\n      });\n      this.plugin.setPluginState({\n        currentSelection: _currentSelection\n      });\n      return;\n    }\n\n    this.lastCheckbox = file;\n\n    var _this$plugin$getPlugi2 = this.plugin.getPluginState(),\n        currentSelection = _this$plugin$getPlugi2.currentSelection;\n\n    if (this.isChecked(file)) {\n      this.plugin.setPluginState({\n        currentSelection: currentSelection.filter(function (item) {\n          return item.id !== file.id;\n        })\n      });\n    } else {\n      this.plugin.setPluginState({\n        currentSelection: currentSelection.concat([file])\n      });\n    }\n  };\n\n  _proto.isChecked = function isChecked(file) {\n    var _this$plugin$getPlugi3 = this.plugin.getPluginState(),\n        currentSelection = _this$plugin$getPlugi3.currentSelection; // comparing id instead of the file object, because the reference to the object\n    // changes when we switch folders, and the file list is updated\n\n\n    return currentSelection.some(function (item) {\n      return item.id === file.id;\n    });\n  };\n\n  _proto.loaderWrapper = function loaderWrapper(promise, then, catch_) {\n    var _this2 = this;\n\n    promise.then(function (result) {\n      _this2.plugin.setPluginState({\n        loading: false\n      });\n\n      then(result);\n    }).catch(function (err) {\n      _this2.plugin.setPluginState({\n        loading: false\n      });\n\n      catch_(err);\n    });\n    this.plugin.setPluginState({\n      loading: true\n    });\n  };\n\n  return SharedHandler;\n}();"],"mappings":"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"},"metadata":{},"sourceType":"script"}
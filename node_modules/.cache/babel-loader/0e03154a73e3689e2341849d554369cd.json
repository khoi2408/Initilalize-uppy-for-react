{"ast":null,"code":"var _class, _temp;\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}\nvar _require = require('preact'),\n  h = _require.h;\nvar AuthView = require('./AuthView');\nvar Header = require('./Header');\nvar Browser = require('../Browser');\nvar LoaderView = require('../Loader');\nvar generateFileID = require('@uppy/utils/lib/generateFileID');\nvar getFileType = require('@uppy/utils/lib/getFileType');\nvar findIndex = require('@uppy/utils/lib/findIndex');\nvar isPreviewSupported = require('@uppy/utils/lib/isPreviewSupported');\nvar SharedHandler = require('../SharedHandler');\nvar CloseWrapper = require('../CloseWrapper'); // location.origin does not exist in IE\n\nfunction getOrigin() {\n  if ('origin' in location) {\n    return location.origin; // eslint-disable-line compat/compat\n  }\n\n  return location.protocol + \"//\" + location.hostname + (location.port ? \":\" + location.port : '');\n}\n/**\n * Class to easily generate generic views for Provider plugins\n */\n\nmodule.exports = (_temp = _class = /*#__PURE__*/function () {\n  /**\n   * @param {object} plugin instance of the plugin\n   * @param {object} opts\n   */\n  function ProviderView(plugin, opts) {\n    this.plugin = plugin;\n    this.provider = opts.provider;\n    this._sharedHandler = new SharedHandler(plugin); // set default options\n\n    var defaultOptions = {\n      viewType: 'list',\n      showTitles: true,\n      showFilter: true,\n      showBreadcrumbs: true\n    }; // merge default options with the ones set by user\n\n    this.opts = _extends({}, defaultOptions, opts); // Logic\n\n    this.addFile = this.addFile.bind(this);\n    this.filterQuery = this.filterQuery.bind(this);\n    this.getFolder = this.getFolder.bind(this);\n    this.getNextFolder = this.getNextFolder.bind(this);\n    this.logout = this.logout.bind(this);\n    this.preFirstRender = this.preFirstRender.bind(this);\n    this.handleAuth = this.handleAuth.bind(this);\n    this.sortByTitle = this.sortByTitle.bind(this);\n    this.sortByDate = this.sortByDate.bind(this);\n    this.handleError = this.handleError.bind(this);\n    this.handleScroll = this.handleScroll.bind(this);\n    this.listAllFiles = this.listAllFiles.bind(this);\n    this.donePicking = this.donePicking.bind(this);\n    this.cancelPicking = this.cancelPicking.bind(this);\n    this.clearSelection = this.clearSelection.bind(this); // Visual\n\n    this.render = this.render.bind(this);\n    this.clearSelection(); // Set default state for the plugin\n\n    this.plugin.setPluginState({\n      authenticated: false,\n      files: [],\n      folders: [],\n      directories: [],\n      filterInput: '',\n      isSearchVisible: false\n    });\n  }\n  var _proto = ProviderView.prototype;\n  _proto.tearDown = function tearDown() {// Nothing.\n  };\n  _proto._updateFilesAndFolders = function _updateFilesAndFolders(res, files, folders) {\n    this.nextPagePath = res.nextPagePath;\n    res.items.forEach(function (item) {\n      if (item.isFolder) {\n        folders.push(item);\n      } else {\n        files.push(item);\n      }\n    });\n    this.plugin.setPluginState({\n      folders: folders,\n      files: files\n    });\n  }\n  /**\n   * Called only the first time the provider view is rendered.\n   * Kind of like an init function.\n   */;\n\n  _proto.preFirstRender = function preFirstRender() {\n    this.plugin.setPluginState({\n      didFirstRender: true\n    });\n    this.plugin.onFirstRender();\n  }\n  /**\n   * Based on folder ID, fetch a new folder and update it to state\n   *\n   * @param  {string} id Folder id\n   * @returns {Promise}   Folders/files in folder\n   */;\n\n  _proto.getFolder = function getFolder(id, name) {\n    var _this = this;\n    return this._sharedHandler.loaderWrapper(this.provider.list(id), function (res) {\n      var folders = [];\n      var files = [];\n      var updatedDirectories;\n      var state = _this.plugin.getPluginState();\n      var index = findIndex(state.directories, function (dir) {\n        return id === dir.id;\n      });\n      if (index !== -1) {\n        updatedDirectories = state.directories.slice(0, index + 1);\n      } else {\n        updatedDirectories = state.directories.concat([{\n          id: id,\n          title: name\n        }]);\n      }\n      _this.username = res.username || _this.username;\n      _this._updateFilesAndFolders(res, files, folders);\n      _this.plugin.setPluginState({\n        directories: updatedDirectories\n      });\n    }, this.handleError);\n  }\n  /**\n   * Fetches new folder\n   *\n   * @param  {object} folder\n   */;\n\n  _proto.getNextFolder = function getNextFolder(folder) {\n    this.getFolder(folder.requestPath, folder.name);\n    this.lastCheckbox = undefined;\n  };\n  _proto.addFile = function addFile(file) {\n    var tagFile = {\n      id: this.providerFileToId(file),\n      source: this.plugin.id,\n      data: file,\n      name: file.name || file.id,\n      type: file.mimeType,\n      isRemote: true,\n      body: {\n        fileId: file.id\n      },\n      remote: {\n        companionUrl: this.plugin.opts.companionUrl,\n        url: \"\" + this.provider.fileUrl(file.requestPath),\n        body: {\n          fileId: file.id\n        },\n        providerOptions: this.provider.opts\n      }\n    };\n    var fileType = getFileType(tagFile); // TODO Should we just always use the thumbnail URL if it exists?\n\n    if (fileType && isPreviewSupported(fileType)) {\n      tagFile.preview = file.thumbnail;\n    }\n    this.plugin.uppy.log('Adding remote file');\n    try {\n      this.plugin.uppy.addFile(tagFile);\n      return true;\n    } catch (err) {\n      if (!err.isRestriction) {\n        this.plugin.uppy.log(err);\n      }\n      return false;\n    }\n  }\n  /**\n   * Removes session token on client side.\n   */;\n\n  _proto.logout = function logout() {\n    var _this2 = this;\n    this.provider.logout().then(function (res) {\n      if (res.ok) {\n        if (!res.revoked) {\n          var message = _this2.plugin.uppy.i18n('companionUnauthorizeHint', {\n            provider: _this2.plugin.title,\n            url: res.manual_revoke_url\n          });\n          _this2.plugin.uppy.info(message, 'info', 7000);\n        }\n        var newState = {\n          authenticated: false,\n          files: [],\n          folders: [],\n          directories: []\n        };\n        _this2.plugin.setPluginState(newState);\n      }\n    }).catch(this.handleError);\n  };\n  _proto.filterQuery = function filterQuery(e) {\n    var state = this.plugin.getPluginState();\n    this.plugin.setPluginState(_extends({}, state, {\n      filterInput: e ? e.target.value : ''\n    }));\n  };\n  _proto.sortByTitle = function sortByTitle() {\n    var state = _extends({}, this.plugin.getPluginState());\n    var files = state.files,\n      folders = state.folders,\n      sorting = state.sorting;\n    var sortedFiles = files.sort(function (fileA, fileB) {\n      if (sorting === 'titleDescending') {\n        return fileB.name.localeCompare(fileA.name);\n      }\n      return fileA.name.localeCompare(fileB.name);\n    });\n    var sortedFolders = folders.sort(function (folderA, folderB) {\n      if (sorting === 'titleDescending') {\n        return folderB.name.localeCompare(folderA.name);\n      }\n      return folderA.name.localeCompare(folderB.name);\n    });\n    this.plugin.setPluginState(_extends({}, state, {\n      files: sortedFiles,\n      folders: sortedFolders,\n      sorting: sorting === 'titleDescending' ? 'titleAscending' : 'titleDescending'\n    }));\n  };\n  _proto.sortByDate = function sortByDate() {\n    var state = _extends({}, this.plugin.getPluginState());\n    var files = state.files,\n      folders = state.folders,\n      sorting = state.sorting;\n    var sortedFiles = files.sort(function (fileA, fileB) {\n      var a = new Date(fileA.modifiedDate);\n      var b = new Date(fileB.modifiedDate);\n      if (sorting === 'dateDescending') {\n        return a > b ? -1 : a < b ? 1 : 0;\n      }\n      return a > b ? 1 : a < b ? -1 : 0;\n    });\n    var sortedFolders = folders.sort(function (folderA, folderB) {\n      var a = new Date(folderA.modifiedDate);\n      var b = new Date(folderB.modifiedDate);\n      if (sorting === 'dateDescending') {\n        return a > b ? -1 : a < b ? 1 : 0;\n      }\n      return a > b ? 1 : a < b ? -1 : 0;\n    });\n    this.plugin.setPluginState(_extends({}, state, {\n      files: sortedFiles,\n      folders: sortedFolders,\n      sorting: sorting === 'dateDescending' ? 'dateAscending' : 'dateDescending'\n    }));\n  };\n  _proto.sortBySize = function sortBySize() {\n    var state = _extends({}, this.plugin.getPluginState());\n    var files = state.files,\n      sorting = state.sorting; // check that plugin supports file sizes\n\n    if (!files.length || !this.plugin.getItemData(files[0]).size) {\n      return;\n    }\n    var sortedFiles = files.sort(function (fileA, fileB) {\n      var a = fileA.size;\n      var b = fileB.size;\n      if (sorting === 'sizeDescending') {\n        return a > b ? -1 : a < b ? 1 : 0;\n      }\n      return a > b ? 1 : a < b ? -1 : 0;\n    });\n    this.plugin.setPluginState(_extends({}, state, {\n      files: sortedFiles,\n      sorting: sorting === 'sizeDescending' ? 'sizeAscending' : 'sizeDescending'\n    }));\n  }\n  /**\n   * Adds all files found inside of specified folder.\n   *\n   * Uses separated state while folder contents are being fetched and\n   * mantains list of selected folders, which are separated from files.\n   */;\n\n  _proto.addFolder = function addFolder(folder) {\n    var _this3 = this;\n    var folderId = this.providerFileToId(folder);\n    var state = this.plugin.getPluginState();\n    var folders = _extends({}, state.selectedFolders);\n    if (folderId in folders && folders[folderId].loading) {\n      return;\n    }\n    folders[folderId] = {\n      loading: true,\n      files: []\n    };\n    this.plugin.setPluginState({\n      selectedFolders: _extends({}, folders)\n    });\n    return this.listAllFiles(folder.requestPath).then(function (files) {\n      var count = 0;\n      files.forEach(function (file) {\n        var success = _this3.addFile(file);\n        if (success) count++;\n      });\n      var ids = files.map(_this3.providerFileToId);\n      folders[folderId] = {\n        loading: false,\n        files: ids\n      };\n      _this3.plugin.setPluginState({\n        selectedFolders: folders\n      });\n      var message;\n      if (files.length) {\n        message = _this3.plugin.uppy.i18n('folderAdded', {\n          smart_count: count,\n          folder: folder.name\n        });\n      } else {\n        message = _this3.plugin.uppy.i18n('emptyFolderAdded');\n      }\n      _this3.plugin.uppy.info(message);\n    }).catch(function (e) {\n      var state = _this3.plugin.getPluginState();\n      var selectedFolders = _extends({}, state.selectedFolders);\n      delete selectedFolders[folderId];\n      _this3.plugin.setPluginState({\n        selectedFolders: selectedFolders\n      });\n      _this3.handleError(e);\n    });\n  };\n  _proto.providerFileToId = function providerFileToId(file) {\n    return generateFileID({\n      data: file,\n      name: file.name || file.id,\n      type: file.mimeType\n    });\n  };\n  _proto.handleAuth = function handleAuth() {\n    var _this4 = this;\n    var authState = btoa(JSON.stringify({\n      origin: getOrigin()\n    }));\n    var clientVersion = \"@uppy/provider-views=\" + ProviderView.VERSION;\n    var link = this.provider.authUrl({\n      state: authState,\n      uppyVersions: clientVersion\n    });\n    var authWindow = window.open(link, '_blank');\n    var handleToken = function handleToken(e) {\n      if (!_this4._isOriginAllowed(e.origin, _this4.plugin.opts.companionAllowedHosts) || e.source !== authWindow) {\n        _this4.plugin.uppy.log(\"rejecting event from \" + e.origin + \" vs allowed pattern \" + _this4.plugin.opts.companionAllowedHosts);\n        return;\n      } // Check if it's a string before doing the JSON.parse to maintain support\n      // for older Companion versions that used object references\n\n      var data = typeof e.data === 'string' ? JSON.parse(e.data) : e.data;\n      if (!data.token) {\n        _this4.plugin.uppy.log('did not receive token from auth window');\n        return;\n      }\n      authWindow.close();\n      window.removeEventListener('message', handleToken);\n      _this4.provider.setAuthToken(data.token);\n      _this4.preFirstRender();\n    };\n    window.addEventListener('message', handleToken);\n  };\n  _proto._isOriginAllowed = function _isOriginAllowed(origin, allowedOrigin) {\n    var getRegex = function getRegex(value) {\n      if (typeof value === 'string') {\n        return new RegExp(\"^\" + value + \"$\");\n      }\n      if (value instanceof RegExp) {\n        return value;\n      }\n    };\n    var patterns = Array.isArray(allowedOrigin) ? allowedOrigin.map(getRegex) : [getRegex(allowedOrigin)];\n    return patterns.filter(function (pattern) {\n      return pattern != null;\n    }) // loose comparison to catch undefined\n    .some(function (pattern) {\n      return pattern.test(origin) || pattern.test(origin + \"/\");\n    }); // allowing for trailing '/'\n  };\n\n  _proto.handleError = function handleError(error) {\n    var uppy = this.plugin.uppy;\n    uppy.log(error.toString());\n    if (error.isAuthError) {\n      return;\n    }\n    var message = uppy.i18n('companionError');\n    uppy.info({\n      message: message,\n      details: error.toString()\n    }, 'error', 5000);\n  };\n  _proto.handleScroll = function handleScroll(e) {\n    var _this5 = this;\n    var scrollPos = e.target.scrollHeight - (e.target.scrollTop + e.target.offsetHeight);\n    var path = this.nextPagePath || null;\n    if (scrollPos < 50 && path && !this._isHandlingScroll) {\n      this.provider.list(path).then(function (res) {\n        var _this5$plugin$getPlug = _this5.plugin.getPluginState(),\n          files = _this5$plugin$getPlug.files,\n          folders = _this5$plugin$getPlug.folders;\n        _this5._updateFilesAndFolders(res, files, folders);\n      }).catch(this.handleError).then(function () {\n        _this5._isHandlingScroll = false;\n      }); // always called\n\n      this._isHandlingScroll = true;\n    }\n  };\n  _proto.listAllFiles = function listAllFiles(path, files) {\n    var _this6 = this;\n    if (files === void 0) {\n      files = null;\n    }\n    files = files || [];\n    return new Promise(function (resolve, reject) {\n      _this6.provider.list(path).then(function (res) {\n        res.items.forEach(function (item) {\n          if (!item.isFolder) {\n            files.push(item);\n          } else {\n            _this6.addFolder(item);\n          }\n        });\n        var moreFiles = res.nextPagePath || null;\n        if (moreFiles) {\n          return _this6.listAllFiles(moreFiles, files).then(function (files) {\n            return resolve(files);\n          }).catch(function (e) {\n            return reject(e);\n          });\n        }\n        return resolve(files);\n      }).catch(function (e) {\n        return reject(e);\n      });\n    });\n  };\n  _proto.donePicking = function donePicking() {\n    var _this7 = this;\n    var _this$plugin$getPlugi = this.plugin.getPluginState(),\n      currentSelection = _this$plugin$getPlugi.currentSelection;\n    var promises = currentSelection.map(function (file) {\n      if (file.isFolder) {\n        return _this7.addFolder(file);\n      }\n      return _this7.addFile(file);\n    });\n    this._sharedHandler.loaderWrapper(Promise.all(promises), function () {\n      _this7.clearSelection();\n    }, function () {});\n  };\n  _proto.cancelPicking = function cancelPicking() {\n    this.clearSelection();\n    var dashboard = this.plugin.uppy.getPlugin('Dashboard');\n    if (dashboard) dashboard.hideAllPanels();\n  };\n  _proto.clearSelection = function clearSelection() {\n    this.plugin.setPluginState({\n      currentSelection: []\n    });\n  };\n  _proto.render = function render(state, viewOptions) {\n    if (viewOptions === void 0) {\n      viewOptions = {};\n    }\n    var _this$plugin$getPlugi2 = this.plugin.getPluginState(),\n      authenticated = _this$plugin$getPlugi2.authenticated,\n      didFirstRender = _this$plugin$getPlugi2.didFirstRender;\n    if (!didFirstRender) {\n      this.preFirstRender();\n    } // reload pluginState for \"loading\" attribute because it might\n    // have changed above.\n\n    if (this.plugin.getPluginState().loading) {\n      return h(CloseWrapper, {\n        onUnmount: this.clearSelection\n      }, h(LoaderView, {\n        i18n: this.plugin.uppy.i18n\n      }));\n    }\n    if (!authenticated) {\n      return h(CloseWrapper, {\n        onUnmount: this.clearSelection\n      }, h(AuthView, {\n        pluginName: this.plugin.title,\n        pluginIcon: this.plugin.icon,\n        handleAuth: this.handleAuth,\n        i18n: this.plugin.uppy.i18n,\n        i18nArray: this.plugin.uppy.i18nArray\n      }));\n    }\n    var targetViewOptions = _extends({}, this.opts, viewOptions);\n    var headerProps = {\n      showBreadcrumbs: targetViewOptions.showBreadcrumbs,\n      getFolder: this.getFolder,\n      directories: this.plugin.getPluginState().directories,\n      pluginIcon: this.plugin.icon,\n      title: this.plugin.title,\n      logout: this.logout,\n      username: this.username,\n      i18n: this.plugin.uppy.i18n\n    };\n    var browserProps = _extends({}, this.plugin.getPluginState(), {\n      username: this.username,\n      getNextFolder: this.getNextFolder,\n      getFolder: this.getFolder,\n      filterItems: this._sharedHandler.filterItems,\n      filterQuery: this.filterQuery,\n      sortByTitle: this.sortByTitle,\n      sortByDate: this.sortByDate,\n      logout: this.logout,\n      isChecked: this._sharedHandler.isChecked,\n      toggleCheckbox: this._sharedHandler.toggleCheckbox,\n      handleScroll: this.handleScroll,\n      listAllFiles: this.listAllFiles,\n      done: this.donePicking,\n      cancel: this.cancelPicking,\n      headerComponent: Header(headerProps),\n      title: this.plugin.title,\n      viewType: targetViewOptions.viewType,\n      showTitles: targetViewOptions.showTitles,\n      showFilter: targetViewOptions.showFilter,\n      showBreadcrumbs: targetViewOptions.showBreadcrumbs,\n      pluginIcon: this.plugin.icon,\n      i18n: this.plugin.uppy.i18n,\n      uppyFiles: this.plugin.uppy.getFiles(),\n      validateRestrictions: this.plugin.uppy.validateRestrictions\n    });\n    return h(CloseWrapper, {\n      onUnmount: this.clearSelection\n    }, h(Browser, browserProps));\n  };\n  return ProviderView;\n}(), _class.VERSION = \"1.12.3\", _temp);","map":{"version":3,"names":["_class","_temp","_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","_require","require","h","AuthView","Header","Browser","LoaderView","generateFileID","getFileType","findIndex","isPreviewSupported","SharedHandler","CloseWrapper","getOrigin","location","origin","protocol","hostname","port","module","exports","ProviderView","plugin","opts","provider","_sharedHandler","defaultOptions","viewType","showTitles","showFilter","showBreadcrumbs","addFile","bind","filterQuery","getFolder","getNextFolder","logout","preFirstRender","handleAuth","sortByTitle","sortByDate","handleError","handleScroll","listAllFiles","donePicking","cancelPicking","clearSelection","render","setPluginState","authenticated","files","folders","directories","filterInput","isSearchVisible","_proto","tearDown","_updateFilesAndFolders","res","nextPagePath","items","forEach","item","isFolder","push","didFirstRender","onFirstRender","id","name","_this","loaderWrapper","list","updatedDirectories","state","getPluginState","index","dir","slice","concat","title","username","folder","requestPath","lastCheckbox","undefined","file","tagFile","providerFileToId","data","type","mimeType","isRemote","body","fileId","remote","companionUrl","url","fileUrl","providerOptions","fileType","preview","thumbnail","uppy","log","err","isRestriction","_this2","then","ok","revoked","message","i18n","manual_revoke_url","info","newState","catch","e","value","sorting","sortedFiles","sort","fileA","fileB","localeCompare","sortedFolders","folderA","folderB","a","Date","modifiedDate","b","sortBySize","getItemData","size","addFolder","_this3","folderId","selectedFolders","loading","count","success","ids","map","smart_count","_this4","authState","btoa","JSON","stringify","clientVersion","VERSION","link","authUrl","uppyVersions","authWindow","window","open","handleToken","_isOriginAllowed","companionAllowedHosts","parse","token","close","removeEventListener","setAuthToken","addEventListener","allowedOrigin","getRegex","RegExp","patterns","Array","isArray","filter","pattern","some","test","error","toString","isAuthError","details","_this5","scrollPos","scrollHeight","scrollTop","offsetHeight","path","_isHandlingScroll","_this5$plugin$getPlug","_this6","Promise","resolve","reject","moreFiles","_this7","_this$plugin$getPlugi","currentSelection","promises","all","dashboard","getPlugin","hideAllPanels","viewOptions","_this$plugin$getPlugi2","onUnmount","pluginName","pluginIcon","icon","i18nArray","targetViewOptions","headerProps","browserProps","filterItems","isChecked","toggleCheckbox","done","cancel","headerComponent","uppyFiles","getFiles","validateRestrictions"],"sources":["E:/integrate cloud/uppy/node_modules/@uppy/provider-views/lib/ProviderView/ProviderView.js"],"sourcesContent":["var _class, _temp;\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nvar _require = require('preact'),\n    h = _require.h;\n\nvar AuthView = require('./AuthView');\n\nvar Header = require('./Header');\n\nvar Browser = require('../Browser');\n\nvar LoaderView = require('../Loader');\n\nvar generateFileID = require('@uppy/utils/lib/generateFileID');\n\nvar getFileType = require('@uppy/utils/lib/getFileType');\n\nvar findIndex = require('@uppy/utils/lib/findIndex');\n\nvar isPreviewSupported = require('@uppy/utils/lib/isPreviewSupported');\n\nvar SharedHandler = require('../SharedHandler');\n\nvar CloseWrapper = require('../CloseWrapper'); // location.origin does not exist in IE\n\n\nfunction getOrigin() {\n  if ('origin' in location) {\n    return location.origin; // eslint-disable-line compat/compat\n  }\n\n  return location.protocol + \"//\" + location.hostname + (location.port ? \":\" + location.port : '');\n}\n/**\n * Class to easily generate generic views for Provider plugins\n */\n\n\nmodule.exports = (_temp = _class = /*#__PURE__*/function () {\n  /**\n   * @param {object} plugin instance of the plugin\n   * @param {object} opts\n   */\n  function ProviderView(plugin, opts) {\n    this.plugin = plugin;\n    this.provider = opts.provider;\n    this._sharedHandler = new SharedHandler(plugin); // set default options\n\n    var defaultOptions = {\n      viewType: 'list',\n      showTitles: true,\n      showFilter: true,\n      showBreadcrumbs: true\n    }; // merge default options with the ones set by user\n\n    this.opts = _extends({}, defaultOptions, opts); // Logic\n\n    this.addFile = this.addFile.bind(this);\n    this.filterQuery = this.filterQuery.bind(this);\n    this.getFolder = this.getFolder.bind(this);\n    this.getNextFolder = this.getNextFolder.bind(this);\n    this.logout = this.logout.bind(this);\n    this.preFirstRender = this.preFirstRender.bind(this);\n    this.handleAuth = this.handleAuth.bind(this);\n    this.sortByTitle = this.sortByTitle.bind(this);\n    this.sortByDate = this.sortByDate.bind(this);\n    this.handleError = this.handleError.bind(this);\n    this.handleScroll = this.handleScroll.bind(this);\n    this.listAllFiles = this.listAllFiles.bind(this);\n    this.donePicking = this.donePicking.bind(this);\n    this.cancelPicking = this.cancelPicking.bind(this);\n    this.clearSelection = this.clearSelection.bind(this); // Visual\n\n    this.render = this.render.bind(this);\n    this.clearSelection(); // Set default state for the plugin\n\n    this.plugin.setPluginState({\n      authenticated: false,\n      files: [],\n      folders: [],\n      directories: [],\n      filterInput: '',\n      isSearchVisible: false\n    });\n  }\n\n  var _proto = ProviderView.prototype;\n\n  _proto.tearDown = function tearDown() {// Nothing.\n  };\n\n  _proto._updateFilesAndFolders = function _updateFilesAndFolders(res, files, folders) {\n    this.nextPagePath = res.nextPagePath;\n    res.items.forEach(function (item) {\n      if (item.isFolder) {\n        folders.push(item);\n      } else {\n        files.push(item);\n      }\n    });\n    this.plugin.setPluginState({\n      folders: folders,\n      files: files\n    });\n  }\n  /**\n   * Called only the first time the provider view is rendered.\n   * Kind of like an init function.\n   */\n  ;\n\n  _proto.preFirstRender = function preFirstRender() {\n    this.plugin.setPluginState({\n      didFirstRender: true\n    });\n    this.plugin.onFirstRender();\n  }\n  /**\n   * Based on folder ID, fetch a new folder and update it to state\n   *\n   * @param  {string} id Folder id\n   * @returns {Promise}   Folders/files in folder\n   */\n  ;\n\n  _proto.getFolder = function getFolder(id, name) {\n    var _this = this;\n\n    return this._sharedHandler.loaderWrapper(this.provider.list(id), function (res) {\n      var folders = [];\n      var files = [];\n      var updatedDirectories;\n\n      var state = _this.plugin.getPluginState();\n\n      var index = findIndex(state.directories, function (dir) {\n        return id === dir.id;\n      });\n\n      if (index !== -1) {\n        updatedDirectories = state.directories.slice(0, index + 1);\n      } else {\n        updatedDirectories = state.directories.concat([{\n          id: id,\n          title: name\n        }]);\n      }\n\n      _this.username = res.username || _this.username;\n\n      _this._updateFilesAndFolders(res, files, folders);\n\n      _this.plugin.setPluginState({\n        directories: updatedDirectories\n      });\n    }, this.handleError);\n  }\n  /**\n   * Fetches new folder\n   *\n   * @param  {object} folder\n   */\n  ;\n\n  _proto.getNextFolder = function getNextFolder(folder) {\n    this.getFolder(folder.requestPath, folder.name);\n    this.lastCheckbox = undefined;\n  };\n\n  _proto.addFile = function addFile(file) {\n    var tagFile = {\n      id: this.providerFileToId(file),\n      source: this.plugin.id,\n      data: file,\n      name: file.name || file.id,\n      type: file.mimeType,\n      isRemote: true,\n      body: {\n        fileId: file.id\n      },\n      remote: {\n        companionUrl: this.plugin.opts.companionUrl,\n        url: \"\" + this.provider.fileUrl(file.requestPath),\n        body: {\n          fileId: file.id\n        },\n        providerOptions: this.provider.opts\n      }\n    };\n    var fileType = getFileType(tagFile); // TODO Should we just always use the thumbnail URL if it exists?\n\n    if (fileType && isPreviewSupported(fileType)) {\n      tagFile.preview = file.thumbnail;\n    }\n\n    this.plugin.uppy.log('Adding remote file');\n\n    try {\n      this.plugin.uppy.addFile(tagFile);\n      return true;\n    } catch (err) {\n      if (!err.isRestriction) {\n        this.plugin.uppy.log(err);\n      }\n\n      return false;\n    }\n  }\n  /**\n   * Removes session token on client side.\n   */\n  ;\n\n  _proto.logout = function logout() {\n    var _this2 = this;\n\n    this.provider.logout().then(function (res) {\n      if (res.ok) {\n        if (!res.revoked) {\n          var message = _this2.plugin.uppy.i18n('companionUnauthorizeHint', {\n            provider: _this2.plugin.title,\n            url: res.manual_revoke_url\n          });\n\n          _this2.plugin.uppy.info(message, 'info', 7000);\n        }\n\n        var newState = {\n          authenticated: false,\n          files: [],\n          folders: [],\n          directories: []\n        };\n\n        _this2.plugin.setPluginState(newState);\n      }\n    }).catch(this.handleError);\n  };\n\n  _proto.filterQuery = function filterQuery(e) {\n    var state = this.plugin.getPluginState();\n    this.plugin.setPluginState(_extends({}, state, {\n      filterInput: e ? e.target.value : ''\n    }));\n  };\n\n  _proto.sortByTitle = function sortByTitle() {\n    var state = _extends({}, this.plugin.getPluginState());\n\n    var files = state.files,\n        folders = state.folders,\n        sorting = state.sorting;\n    var sortedFiles = files.sort(function (fileA, fileB) {\n      if (sorting === 'titleDescending') {\n        return fileB.name.localeCompare(fileA.name);\n      }\n\n      return fileA.name.localeCompare(fileB.name);\n    });\n    var sortedFolders = folders.sort(function (folderA, folderB) {\n      if (sorting === 'titleDescending') {\n        return folderB.name.localeCompare(folderA.name);\n      }\n\n      return folderA.name.localeCompare(folderB.name);\n    });\n    this.plugin.setPluginState(_extends({}, state, {\n      files: sortedFiles,\n      folders: sortedFolders,\n      sorting: sorting === 'titleDescending' ? 'titleAscending' : 'titleDescending'\n    }));\n  };\n\n  _proto.sortByDate = function sortByDate() {\n    var state = _extends({}, this.plugin.getPluginState());\n\n    var files = state.files,\n        folders = state.folders,\n        sorting = state.sorting;\n    var sortedFiles = files.sort(function (fileA, fileB) {\n      var a = new Date(fileA.modifiedDate);\n      var b = new Date(fileB.modifiedDate);\n\n      if (sorting === 'dateDescending') {\n        return a > b ? -1 : a < b ? 1 : 0;\n      }\n\n      return a > b ? 1 : a < b ? -1 : 0;\n    });\n    var sortedFolders = folders.sort(function (folderA, folderB) {\n      var a = new Date(folderA.modifiedDate);\n      var b = new Date(folderB.modifiedDate);\n\n      if (sorting === 'dateDescending') {\n        return a > b ? -1 : a < b ? 1 : 0;\n      }\n\n      return a > b ? 1 : a < b ? -1 : 0;\n    });\n    this.plugin.setPluginState(_extends({}, state, {\n      files: sortedFiles,\n      folders: sortedFolders,\n      sorting: sorting === 'dateDescending' ? 'dateAscending' : 'dateDescending'\n    }));\n  };\n\n  _proto.sortBySize = function sortBySize() {\n    var state = _extends({}, this.plugin.getPluginState());\n\n    var files = state.files,\n        sorting = state.sorting; // check that plugin supports file sizes\n\n    if (!files.length || !this.plugin.getItemData(files[0]).size) {\n      return;\n    }\n\n    var sortedFiles = files.sort(function (fileA, fileB) {\n      var a = fileA.size;\n      var b = fileB.size;\n\n      if (sorting === 'sizeDescending') {\n        return a > b ? -1 : a < b ? 1 : 0;\n      }\n\n      return a > b ? 1 : a < b ? -1 : 0;\n    });\n    this.plugin.setPluginState(_extends({}, state, {\n      files: sortedFiles,\n      sorting: sorting === 'sizeDescending' ? 'sizeAscending' : 'sizeDescending'\n    }));\n  }\n  /**\n   * Adds all files found inside of specified folder.\n   *\n   * Uses separated state while folder contents are being fetched and\n   * mantains list of selected folders, which are separated from files.\n   */\n  ;\n\n  _proto.addFolder = function addFolder(folder) {\n    var _this3 = this;\n\n    var folderId = this.providerFileToId(folder);\n    var state = this.plugin.getPluginState();\n\n    var folders = _extends({}, state.selectedFolders);\n\n    if (folderId in folders && folders[folderId].loading) {\n      return;\n    }\n\n    folders[folderId] = {\n      loading: true,\n      files: []\n    };\n    this.plugin.setPluginState({\n      selectedFolders: _extends({}, folders)\n    });\n    return this.listAllFiles(folder.requestPath).then(function (files) {\n      var count = 0;\n      files.forEach(function (file) {\n        var success = _this3.addFile(file);\n\n        if (success) count++;\n      });\n      var ids = files.map(_this3.providerFileToId);\n      folders[folderId] = {\n        loading: false,\n        files: ids\n      };\n\n      _this3.plugin.setPluginState({\n        selectedFolders: folders\n      });\n\n      var message;\n\n      if (files.length) {\n        message = _this3.plugin.uppy.i18n('folderAdded', {\n          smart_count: count,\n          folder: folder.name\n        });\n      } else {\n        message = _this3.plugin.uppy.i18n('emptyFolderAdded');\n      }\n\n      _this3.plugin.uppy.info(message);\n    }).catch(function (e) {\n      var state = _this3.plugin.getPluginState();\n\n      var selectedFolders = _extends({}, state.selectedFolders);\n\n      delete selectedFolders[folderId];\n\n      _this3.plugin.setPluginState({\n        selectedFolders: selectedFolders\n      });\n\n      _this3.handleError(e);\n    });\n  };\n\n  _proto.providerFileToId = function providerFileToId(file) {\n    return generateFileID({\n      data: file,\n      name: file.name || file.id,\n      type: file.mimeType\n    });\n  };\n\n  _proto.handleAuth = function handleAuth() {\n    var _this4 = this;\n\n    var authState = btoa(JSON.stringify({\n      origin: getOrigin()\n    }));\n    var clientVersion = \"@uppy/provider-views=\" + ProviderView.VERSION;\n    var link = this.provider.authUrl({\n      state: authState,\n      uppyVersions: clientVersion\n    });\n    var authWindow = window.open(link, '_blank');\n\n    var handleToken = function handleToken(e) {\n      if (!_this4._isOriginAllowed(e.origin, _this4.plugin.opts.companionAllowedHosts) || e.source !== authWindow) {\n        _this4.plugin.uppy.log(\"rejecting event from \" + e.origin + \" vs allowed pattern \" + _this4.plugin.opts.companionAllowedHosts);\n\n        return;\n      } // Check if it's a string before doing the JSON.parse to maintain support\n      // for older Companion versions that used object references\n\n\n      var data = typeof e.data === 'string' ? JSON.parse(e.data) : e.data;\n\n      if (!data.token) {\n        _this4.plugin.uppy.log('did not receive token from auth window');\n\n        return;\n      }\n\n      authWindow.close();\n      window.removeEventListener('message', handleToken);\n\n      _this4.provider.setAuthToken(data.token);\n\n      _this4.preFirstRender();\n    };\n\n    window.addEventListener('message', handleToken);\n  };\n\n  _proto._isOriginAllowed = function _isOriginAllowed(origin, allowedOrigin) {\n    var getRegex = function getRegex(value) {\n      if (typeof value === 'string') {\n        return new RegExp(\"^\" + value + \"$\");\n      }\n\n      if (value instanceof RegExp) {\n        return value;\n      }\n    };\n\n    var patterns = Array.isArray(allowedOrigin) ? allowedOrigin.map(getRegex) : [getRegex(allowedOrigin)];\n    return patterns.filter(function (pattern) {\n      return pattern != null;\n    }) // loose comparison to catch undefined\n    .some(function (pattern) {\n      return pattern.test(origin) || pattern.test(origin + \"/\");\n    }); // allowing for trailing '/'\n  };\n\n  _proto.handleError = function handleError(error) {\n    var uppy = this.plugin.uppy;\n    uppy.log(error.toString());\n\n    if (error.isAuthError) {\n      return;\n    }\n\n    var message = uppy.i18n('companionError');\n    uppy.info({\n      message: message,\n      details: error.toString()\n    }, 'error', 5000);\n  };\n\n  _proto.handleScroll = function handleScroll(e) {\n    var _this5 = this;\n\n    var scrollPos = e.target.scrollHeight - (e.target.scrollTop + e.target.offsetHeight);\n    var path = this.nextPagePath || null;\n\n    if (scrollPos < 50 && path && !this._isHandlingScroll) {\n      this.provider.list(path).then(function (res) {\n        var _this5$plugin$getPlug = _this5.plugin.getPluginState(),\n            files = _this5$plugin$getPlug.files,\n            folders = _this5$plugin$getPlug.folders;\n\n        _this5._updateFilesAndFolders(res, files, folders);\n      }).catch(this.handleError).then(function () {\n        _this5._isHandlingScroll = false;\n      }); // always called\n\n      this._isHandlingScroll = true;\n    }\n  };\n\n  _proto.listAllFiles = function listAllFiles(path, files) {\n    var _this6 = this;\n\n    if (files === void 0) {\n      files = null;\n    }\n\n    files = files || [];\n    return new Promise(function (resolve, reject) {\n      _this6.provider.list(path).then(function (res) {\n        res.items.forEach(function (item) {\n          if (!item.isFolder) {\n            files.push(item);\n          } else {\n            _this6.addFolder(item);\n          }\n        });\n        var moreFiles = res.nextPagePath || null;\n\n        if (moreFiles) {\n          return _this6.listAllFiles(moreFiles, files).then(function (files) {\n            return resolve(files);\n          }).catch(function (e) {\n            return reject(e);\n          });\n        }\n\n        return resolve(files);\n      }).catch(function (e) {\n        return reject(e);\n      });\n    });\n  };\n\n  _proto.donePicking = function donePicking() {\n    var _this7 = this;\n\n    var _this$plugin$getPlugi = this.plugin.getPluginState(),\n        currentSelection = _this$plugin$getPlugi.currentSelection;\n\n    var promises = currentSelection.map(function (file) {\n      if (file.isFolder) {\n        return _this7.addFolder(file);\n      }\n\n      return _this7.addFile(file);\n    });\n\n    this._sharedHandler.loaderWrapper(Promise.all(promises), function () {\n      _this7.clearSelection();\n    }, function () {});\n  };\n\n  _proto.cancelPicking = function cancelPicking() {\n    this.clearSelection();\n    var dashboard = this.plugin.uppy.getPlugin('Dashboard');\n    if (dashboard) dashboard.hideAllPanels();\n  };\n\n  _proto.clearSelection = function clearSelection() {\n    this.plugin.setPluginState({\n      currentSelection: []\n    });\n  };\n\n  _proto.render = function render(state, viewOptions) {\n    if (viewOptions === void 0) {\n      viewOptions = {};\n    }\n\n    var _this$plugin$getPlugi2 = this.plugin.getPluginState(),\n        authenticated = _this$plugin$getPlugi2.authenticated,\n        didFirstRender = _this$plugin$getPlugi2.didFirstRender;\n\n    if (!didFirstRender) {\n      this.preFirstRender();\n    } // reload pluginState for \"loading\" attribute because it might\n    // have changed above.\n\n\n    if (this.plugin.getPluginState().loading) {\n      return h(CloseWrapper, {\n        onUnmount: this.clearSelection\n      }, h(LoaderView, {\n        i18n: this.plugin.uppy.i18n\n      }));\n    }\n\n    if (!authenticated) {\n      return h(CloseWrapper, {\n        onUnmount: this.clearSelection\n      }, h(AuthView, {\n        pluginName: this.plugin.title,\n        pluginIcon: this.plugin.icon,\n        handleAuth: this.handleAuth,\n        i18n: this.plugin.uppy.i18n,\n        i18nArray: this.plugin.uppy.i18nArray\n      }));\n    }\n\n    var targetViewOptions = _extends({}, this.opts, viewOptions);\n\n    var headerProps = {\n      showBreadcrumbs: targetViewOptions.showBreadcrumbs,\n      getFolder: this.getFolder,\n      directories: this.plugin.getPluginState().directories,\n      pluginIcon: this.plugin.icon,\n      title: this.plugin.title,\n      logout: this.logout,\n      username: this.username,\n      i18n: this.plugin.uppy.i18n\n    };\n\n    var browserProps = _extends({}, this.plugin.getPluginState(), {\n      username: this.username,\n      getNextFolder: this.getNextFolder,\n      getFolder: this.getFolder,\n      filterItems: this._sharedHandler.filterItems,\n      filterQuery: this.filterQuery,\n      sortByTitle: this.sortByTitle,\n      sortByDate: this.sortByDate,\n      logout: this.logout,\n      isChecked: this._sharedHandler.isChecked,\n      toggleCheckbox: this._sharedHandler.toggleCheckbox,\n      handleScroll: this.handleScroll,\n      listAllFiles: this.listAllFiles,\n      done: this.donePicking,\n      cancel: this.cancelPicking,\n      headerComponent: Header(headerProps),\n      title: this.plugin.title,\n      viewType: targetViewOptions.viewType,\n      showTitles: targetViewOptions.showTitles,\n      showFilter: targetViewOptions.showFilter,\n      showBreadcrumbs: targetViewOptions.showBreadcrumbs,\n      pluginIcon: this.plugin.icon,\n      i18n: this.plugin.uppy.i18n,\n      uppyFiles: this.plugin.uppy.getFiles(),\n      validateRestrictions: this.plugin.uppy.validateRestrictions\n    });\n\n    return h(CloseWrapper, {\n      onUnmount: this.clearSelection\n    }, h(Browser, browserProps));\n  };\n\n  return ProviderView;\n}(), _class.VERSION = \"1.12.3\", _temp);"],"mappings":"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"},"metadata":{},"sourceType":"script"}
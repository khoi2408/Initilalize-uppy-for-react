{"ast":null,"code":"import _classCallCheck from \"E:/integrate cloud/uppy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"E:/integrate cloud/uppy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport getFileType from '@uppy/utils/lib/getFileType';\nimport isPreviewSupported from '@uppy/utils/lib/isPreviewSupported';\nimport generateFileID from '@uppy/utils/lib/generateFileID'; // TODO: now that we have a shared `View` class,\n// `SharedHandler` could be cleaned up and moved into here\n\nimport SharedHandler from './SharedHandler.js';\nvar View = /*#__PURE__*/function () {\n  function View(plugin, opts) {\n    _classCallCheck(this, View);\n    this.plugin = plugin;\n    this.provider = opts.provider;\n    this.sharedHandler = new SharedHandler(plugin);\n    this.isHandlingScroll = false;\n    this.preFirstRender = this.preFirstRender.bind(this);\n    this.handleError = this.handleError.bind(this);\n    this.addFile = this.addFile.bind(this);\n    this.clearSelection = this.clearSelection.bind(this);\n    this.cancelPicking = this.cancelPicking.bind(this);\n  } // eslint-disable-next-line class-methods-use-this\n  _createClass(View, [{\n    key: \"providerFileToId\",\n    value: function providerFileToId(file) {\n      return generateFileID({\n        data: file,\n        name: file.name || file.id,\n        type: file.mimetype\n      });\n    }\n  }, {\n    key: \"preFirstRender\",\n    value: function preFirstRender() {\n      this.plugin.setPluginState({\n        didFirstRender: true\n      });\n      this.plugin.onFirstRender();\n    } // eslint-disable-next-line class-methods-use-this\n  }, {\n    key: \"shouldHandleScroll\",\n    value: function shouldHandleScroll(event) {\n      var _event$target = event.target,\n        scrollHeight = _event$target.scrollHeight,\n        scrollTop = _event$target.scrollTop,\n        offsetHeight = _event$target.offsetHeight;\n      var scrollPosition = scrollHeight - (scrollTop + offsetHeight);\n      return scrollPosition < 50 && !this.isHandlingScroll;\n    }\n  }, {\n    key: \"clearSelection\",\n    value: function clearSelection() {\n      this.plugin.setPluginState({\n        currentSelection: [],\n        filterInput: ''\n      });\n    }\n  }, {\n    key: \"cancelPicking\",\n    value: function cancelPicking() {\n      this.clearSelection();\n      var dashboard = this.plugin.uppy.getPlugin('Dashboard');\n      if (dashboard) {\n        dashboard.hideAllPanels();\n      }\n    }\n  }, {\n    key: \"handleError\",\n    value: function handleError(error) {\n      var uppy = this.plugin.uppy;\n      var message = uppy.i18n('companionError');\n      uppy.log(error.toString());\n      if (error.isAuthError) {\n        return;\n      }\n      uppy.info({\n        message: message,\n        details: error.toString()\n      }, 'error', 5000);\n    }\n  }, {\n    key: \"addFile\",\n    value: function addFile(file) {\n      var tagFile = {\n        id: this.providerFileToId(file),\n        source: this.plugin.id,\n        data: file,\n        name: file.name || file.id,\n        type: file.mimeType,\n        isRemote: true,\n        meta: {},\n        body: {\n          fileId: file.id\n        },\n        remote: {\n          companionUrl: this.plugin.opts.companionUrl,\n          url: \"\".concat(this.provider.fileUrl(file.requestPath)),\n          body: {\n            fileId: file.id\n          },\n          providerOptions: this.provider.opts,\n          providerName: this.provider.name\n        }\n      };\n      var fileType = getFileType(tagFile); // TODO Should we just always use the thumbnail URL if it exists?\n\n      if (fileType && isPreviewSupported(fileType)) {\n        tagFile.preview = file.thumbnail;\n      }\n      if (file.author) {\n        if (file.author.name != null) tagFile.meta.authorName = String(file.author.name);\n        if (file.author.url) tagFile.meta.authorUrl = file.author.url;\n      }\n      this.plugin.uppy.log('Adding remote file');\n      try {\n        this.plugin.uppy.addFile(tagFile);\n        return true;\n      } catch (err) {\n        if (!err.isRestriction) {\n          this.plugin.uppy.log(err);\n        }\n        return false;\n      }\n    }\n  }]);\n  return View;\n}();\nexport { View as default };","map":{"version":3,"names":["getFileType","isPreviewSupported","generateFileID","SharedHandler","View","plugin","opts","_classCallCheck","provider","sharedHandler","isHandlingScroll","preFirstRender","bind","handleError","addFile","clearSelection","cancelPicking","_createClass","key","value","providerFileToId","file","data","name","id","type","mimetype","setPluginState","didFirstRender","onFirstRender","shouldHandleScroll","event","_event$target","target","scrollHeight","scrollTop","offsetHeight","scrollPosition","currentSelection","filterInput","dashboard","uppy","getPlugin","hideAllPanels","error","message","i18n","log","toString","isAuthError","info","details","tagFile","source","mimeType","isRemote","meta","body","fileId","remote","companionUrl","url","concat","fileUrl","requestPath","providerOptions","providerName","fileType","preview","thumbnail","author","authorName","String","authorUrl","err","isRestriction","default"],"sources":["E:/integrate cloud/uppy/node_modules/@uppy/dropbox/node_modules/@uppy/provider-views/lib/View.js"],"sourcesContent":["import getFileType from '@uppy/utils/lib/getFileType';\nimport isPreviewSupported from '@uppy/utils/lib/isPreviewSupported';\nimport generateFileID from '@uppy/utils/lib/generateFileID'; // TODO: now that we have a shared `View` class,\n// `SharedHandler` could be cleaned up and moved into here\n\nimport SharedHandler from './SharedHandler.js';\nexport default class View {\n  constructor(plugin, opts) {\n    this.plugin = plugin;\n    this.provider = opts.provider;\n    this.sharedHandler = new SharedHandler(plugin);\n    this.isHandlingScroll = false;\n    this.preFirstRender = this.preFirstRender.bind(this);\n    this.handleError = this.handleError.bind(this);\n    this.addFile = this.addFile.bind(this);\n    this.clearSelection = this.clearSelection.bind(this);\n    this.cancelPicking = this.cancelPicking.bind(this);\n  } // eslint-disable-next-line class-methods-use-this\n\n\n  providerFileToId(file) {\n    return generateFileID({\n      data: file,\n      name: file.name || file.id,\n      type: file.mimetype\n    });\n  }\n\n  preFirstRender() {\n    this.plugin.setPluginState({\n      didFirstRender: true\n    });\n    this.plugin.onFirstRender();\n  } // eslint-disable-next-line class-methods-use-this\n\n\n  shouldHandleScroll(event) {\n    const {\n      scrollHeight,\n      scrollTop,\n      offsetHeight\n    } = event.target;\n    const scrollPosition = scrollHeight - (scrollTop + offsetHeight);\n    return scrollPosition < 50 && !this.isHandlingScroll;\n  }\n\n  clearSelection() {\n    this.plugin.setPluginState({\n      currentSelection: [],\n      filterInput: ''\n    });\n  }\n\n  cancelPicking() {\n    this.clearSelection();\n    const dashboard = this.plugin.uppy.getPlugin('Dashboard');\n\n    if (dashboard) {\n      dashboard.hideAllPanels();\n    }\n  }\n\n  handleError(error) {\n    const {\n      uppy\n    } = this.plugin;\n    const message = uppy.i18n('companionError');\n    uppy.log(error.toString());\n\n    if (error.isAuthError) {\n      return;\n    }\n\n    uppy.info({\n      message,\n      details: error.toString()\n    }, 'error', 5000);\n  }\n\n  addFile(file) {\n    const tagFile = {\n      id: this.providerFileToId(file),\n      source: this.plugin.id,\n      data: file,\n      name: file.name || file.id,\n      type: file.mimeType,\n      isRemote: true,\n      meta: {},\n      body: {\n        fileId: file.id\n      },\n      remote: {\n        companionUrl: this.plugin.opts.companionUrl,\n        url: `${this.provider.fileUrl(file.requestPath)}`,\n        body: {\n          fileId: file.id\n        },\n        providerOptions: this.provider.opts,\n        providerName: this.provider.name\n      }\n    };\n    const fileType = getFileType(tagFile); // TODO Should we just always use the thumbnail URL if it exists?\n\n    if (fileType && isPreviewSupported(fileType)) {\n      tagFile.preview = file.thumbnail;\n    }\n\n    if (file.author) {\n      if (file.author.name != null) tagFile.meta.authorName = String(file.author.name);\n      if (file.author.url) tagFile.meta.authorUrl = file.author.url;\n    }\n\n    this.plugin.uppy.log('Adding remote file');\n\n    try {\n      this.plugin.uppy.addFile(tagFile);\n      return true;\n    } catch (err) {\n      if (!err.isRestriction) {\n        this.plugin.uppy.log(err);\n      }\n\n      return false;\n    }\n  }\n\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}